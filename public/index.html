<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8" />
    <title>MDMML</title>
    <script src="https://cdn.jsdelivr.net/npm/jzz"></script>
    <script src="https://cdn.jsdelivr.net/npm/jzz-synth-tiny"></script>
    <script src="https://cdn.jsdelivr.net/npm/jzz-midi-smf"></script>
    <script src="https://cdn.jsdelivr.net/npm/jzz-gui-player"></script>

    <!-- Load Editor.js's Core -->
    <script src="https://cdn.jsdelivr.net/npm/@editorjs/editorjs@latest"></script>
    <script src="https://cdn.jsdelivr.net/npm/@editorjs/table@latest"></script><!-- Table -->

    <script type="text/javascript" src="./bundle.js"></script>
</head>

<body>
    <div class="block"></div>
    <div id="editorjs"></div>

    <button class="save-button">Convert</button>
    <div id=player></div>

    <script>
        JZZ.synth.Tiny.register('Web Audio');
        const player = new JZZ.gui.Player('player');

        const editor = new EditorJS({
            autofocus: true,
            tools: {
                table: {
                    class: Table,
                    inlineToolbar: true,
                }
            },
            data: {
                time: 1625072989362,
                blocks: [
                    {
                        id: "5Pa_aEnsj9",
                        type: "paragraph",
                        data: {
                            text: 'Title: "お湯はり完了メロディー（人形の夢と目覚め）"'
                        }
                    },
                    {
                        id: "XXVTfnMlcE",
                        type: "table",
                        data: {
                            withHeadings: true,
                            content: [
                                ["name", "1", "2", "3", "4", "5"],
                                ["A", "@11l8o4v120gf", "e4g&gt;c&lt;b4g&gt;d", "c4e4r4c&lt;b", "a4>fdc4&lt;b4&gt;", "c2r2"],
                                ["B", "@11l8o3v100r4", "rgggrggg", "&gt;rcccrccc", "rdddrerf", "rggfe4r4"],
                                ["C", "@11l8o3v100r4", "reeerfff", "rgggrggg", "raaa&gt;rcrd", "reedc4r4"],
                                ["D", "@11l2o3v100r4", "cd", "ee", "fg4g4", "&gt;c4r4r2"]
                            ]
                        }
                    }
                ],
                version: "2.22.1"
            }
        });

        const saveButton = document.querySelector('.save-button');
        saveButton.addEventListener('click', function () {
            editor.save().then((savedData) => {
                const md = JSONtoMD(JSON.stringify(savedData));
                const data = MDtoSMF(md);
                player.stop();
                player.load(new JZZ.MIDI.SMF(data));
            }).catch((error) => {
                console.error('Saving error', error);
            });
        });
    </script>

    <script type="module">
        // Import the functions you need from the SDKs you need
        import { initializeApp } from "https://www.gstatic.com/firebasejs/9.8.2/firebase-app.js";
        import { getAnalytics } from "https://www.gstatic.com/firebasejs/9.8.2/firebase-analytics.js";
        // TODO: Add SDKs for Firebase products that you want to use
        // https://firebase.google.com/docs/web/setup#available-libraries

        // Your web app's Firebase configuration
        // For Firebase JS SDK v7.20.0 and later, measurementId is optional
        const firebaseConfig = {
            apiKey: "AIzaSyBu6Ge6St9qikvjagOWFhUkz8B3ez9juiY",
            authDomain: "mdmml-285c0.firebaseapp.com",
            projectId: "mdmml-285c0",
            storageBucket: "mdmml-285c0.appspot.com",
            messagingSenderId: "945383093006",
            appId: "1:945383093006:web:9293dc238078b85d01dd5f",
            measurementId: "G-L23C4HMSD5"
        };

        // Initialize Firebase
        const app = initializeApp(firebaseConfig);
        const analytics = getAnalytics(app);
    </script>
</body>

</html>